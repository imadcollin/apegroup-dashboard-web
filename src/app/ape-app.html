<link rel="import" href="../config/config.html">
<link rel="import" href="../assets/libs/polymer/polymer.html">
<link rel="import" href="../assets/libs/app-route/app-route.html">
<link rel="import" href="../assets/libs/app-route/app-location.html">
<link rel="import" href="../assets/libs/iron-pages/iron-pages.html">

<link rel="import" href="shared/firebase/firebase.html">
<link rel="import" href="shared/pages/x-pages.html">

<dom-module id="ape-app">

    <template>

        <style>

            :host {
                display: flex;
                flex-direction: column;
                color: #2a2a2a;
            }

            iron-pages {
                display: flex;
                flex-direction: column;
                flex-grow: 1;
                position: relative;
            }

        </style>

        <app-location route="{{route}}"></app-location>
        <app-route route="{{route}}" pattern="/:page" data="{{router}}"></app-route>

        <iron-pages selected="[[page]]" attr-for-selected="selected" selected-attribute="visible" fallback-selection="404" on-iron-select="_listenerIronSelect">
            <ape-home selected="home"></ape-home>
            <ape-board selected="board"></ape-board>
            <ape-employees selected="employees"></ape-employees>
            <ape-style selected="style"></ape-style>
        </iron-pages>

    </template>

    <script>

        Polymer({

            is: `ape-app`,

            behaviors: [

            ],

            properties: {
                router: {
                    type: Object
                },
                page: {
                    type: String
                }
            },

            observers: [
                `_observerRouterPage(router.page)`
            ],

            /* Life cycle */

            ready() {
                firebase.initializeApp(CONFIG.FIREBASE);
            },

            attached() {

            },

            detached() {

            },

            /* Observers */

            _observerRouterPage(page) {
                this.page = (page === ``) ? `home` : page;
            },

            /* Listeners */

            _listenerIronSelect() {
                const name = event.target.selected;
                const importHref = `${this.page}/ape-${name}.html`;
                this.importHref(this.resolveUrl(importHref), null, null, true);
            }

        });

    </script>

</dom-module>