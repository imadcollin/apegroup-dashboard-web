<link rel="import" href="../../assets/libs/polymer/polymer.html">
<link rel="import" href="./../shared/time/ape-time.html">

<dom-module id="ape-employees">

    <template>

        <style>
            :host {
                padding: .5vw;
                flex-wrap: wrap;
                flex-direction: column;
                flex-flow: row wrap;
                display: flex;
                margin: 0;
                background: white;
            }

            .card {
                width: 200px;
                margin: .5vw;
            }

            .card:hover {
                box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
            }

            .container {
                text-align: left;
                background: #eee;
                height: 5.4vw;
                font-size: inherit;
                line-height: normal;
            }

            img {
                width: 100%;
                height: auto;
            }

            .default::before {
                content: ".";
                color: green;
                font-weight: bold;
                line-height: 0px;
                font-size: 7rem;
            }

            .red {
                background: red;
            }
        </style>
        <template is="dom-repeat" items="{{users}}" as="user" sort="_sort">


            <div class="card">
                <img src="[[user.imageURL]]" alt="Avatar" style="width:100%">
                <div class="container">
                    <span id="colorElement" class="default"> </span>[[user.firstname]] [[user.lastname]]
                    <!--<p>[[isInOffice]] </p>-->
                    <!--<p>[[user.email]]</p>-->

                </div>
            </div>
        </template>

    </template>
    <script>

    </script>
    <script>
        Polymer({

            is: `ape-employees`,

            behaviors: [
            ],

            properties: {
                users: {
                    type: Array,
                    value: function () {
                        return [];
                    }
                },
                user: {
                    type: Object,

                },
                isInOffice: {
                    type: String,
                },
                isInMeeting: {
                    type: String,

                }

            },

            /* Life cycle */

            ready() {
            },

            attached() {

                var database = firebase.database();
                database.ref(`/users`).once(`value`).then((snapshot) => {
                    const items = snapshot.val();
                    this.users = Object.keys(items).map(key => items[key]);
                    this.checkStatus();
                    this.InMeeting();
                });

            },

            detached() {
            },

            _sort(a, b) {

                if (a.firstname === b.firstname) return 0;
                return a.firstname < b.firstname ? -1 : 1;
            },
            checkStatus() {
                let userStatus;
                if (this.users !== null || this.users !== undefined) {
                    userStatus = this.users.map(function (x) {
                        return x.isInOffice;
                    });
                    if (userStatus === true) {
                        //do something
                    } else {
                        document.getElementById(`colorElement`).classList.add(`red`);

                    }
                }
            },
            InMeeting() {
                let userStatus;
                if (this.users !== null || this.users !== undefined) {
                    userStatus = this.users.map(function (x) {
                        return x.isInMeeting;
                    });
                    if (userStatus === true) {
                        //do something
                    } else {
                        //do the opposite
                    }
                }
            },




        });
    </script>

</dom-module>